{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Calendar,Clock,Activity,AlertCircle,CheckCircle,ExternalLink}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ExerciseRecommendations=_ref=>{let{prescriptionFile,onClose}=_ref;const[loading,setLoading]=useState(false);const[exerciseData,setExerciseData]=useState(null);const[error,setError]=useState(null);const[calendarIntegration,setCalendarIntegration]=useState({authorized:false,loading:false,events:[]});const[userProfile,setUserProfile]=useState({age:'adult',fitness_level:'beginner',preferences:'general wellness'});const fetchExerciseRecommendations=async()=>{if(!prescriptionFile)return;setLoading(true);setError(null);try{const formData=new FormData();formData.append('file',prescriptionFile);formData.append('user_profile',JSON.stringify(userProfile));const response=await fetch('/api/v1/exercise-recommendations',{method:'POST',body:formData});if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();setExerciseData(data);}catch(err){setError(err.message);console.error('Error fetching exercise recommendations:',err);}finally{setLoading(false);}};const handleGoogleCalendarAuth=async()=>{setCalendarIntegration(prev=>({...prev,loading:true}));try{const response=await fetch('/api/v1/calendar/auth-url',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({state:'exercise_integration'})});const data=await response.json();if(data.success){// Open Google OAuth in a new window\nwindow.open(data.authorization_url,'google-auth','width=500,height=600');// Listen for the auth completion (you'd implement this based on your OAuth flow)\n// For now, we'll simulate success\nsetTimeout(()=>{setCalendarIntegration(prev=>({...prev,authorized:true,loading:false}));},3000);}}catch(err){console.error('Error with Google Calendar auth:',err);setCalendarIntegration(prev=>({...prev,loading:false}));}};const createCalendarEvents=async()=>{if(!(exerciseData!==null&&exerciseData!==void 0&&exerciseData.exercise_recommendations)||!calendarIntegration.authorized)return;setCalendarIntegration(prev=>({...prev,loading:true}));try{// In a real implementation, you'd use the actual credentials from OAuth\nconst mockCredentials={access_token:'mock_token',refresh_token:'mock_refresh'// ... other credential fields\n};const response=await fetch('/api/v1/calendar/create-exercise-events',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({credentials:mockCredentials,exercise_plan:exerciseData.exercise_recommendations,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})});const data=await response.json();if(data.success){setCalendarIntegration(prev=>({...prev,events:data.created_events,loading:false}));}}catch(err){console.error('Error creating calendar events:',err);setCalendarIntegration(prev=>({...prev,loading:false}));}};useEffect(()=>{fetchExerciseRecommendations();},[prescriptionFile,userProfile]);// eslint-disable-line react-hooks/exhaustive-deps\nconst renderExerciseCard=(exercise,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-800 flex items-center\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-5 h-5 mr-2 text-blue-500\"}),exercise.name]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500 flex items-center\",children:[/*#__PURE__*/_jsx(Clock,{className:\"w-4 h-4 mr-1\"}),exercise.duration]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-3\",children:exercise.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-700\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Benefits:\"}),\" \",exercise.benefits]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 text-yellow-500 mr-2 mt-0.5 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-700\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Precautions:\"}),\" \",exercise.precautions]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-blue-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Best time:\"}),\" \",exercise.time_of_day]})]})]},index);const renderWeeklyPlan=weeklyPlan=>{const days=['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];return/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:days.map(day=>{var _weeklyPlan$day;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-800 capitalize mb-2\",children:day}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:((_weeklyPlan$day=weeklyPlan[day])===null||_weeklyPlan$day===void 0?void 0:_weeklyPlan$day.map((exercise,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"text-sm text-gray-600 flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-blue-400 rounded-full mr-2\"}),exercise]},index)))||/*#__PURE__*/_jsx(\"li\",{className:\"text-sm text-gray-400\",children:\"Rest day\"})})]},day);})});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-8 max-w-md w-full mx-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Analyzing prescription and generating exercise recommendations...\"})]})})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-8 max-w-md w-full mx-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-12 h-12 text-red-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-2\",children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors\",children:\"Close\"})]})})});}if(!exerciseData)return null;const{diseases,exercise_recommendations}=exerciseData;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 bg-white border-b border-gray-200 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800 flex items-center\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-6 h-6 mr-2 text-blue-500\"}),\"Exercise Recommendations\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-400 hover:text-gray-600 text-2xl font-bold\",children:\"\\xD7\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-8\",children:[diseases&&diseases.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"Detected Medical Conditions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:diseases.map((disease,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium\",children:disease},index))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"User Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Age Group\"}),/*#__PURE__*/_jsxs(\"select\",{value:userProfile.age,onChange:e=>setUserProfile(prev=>({...prev,age:e.target.value})),className:\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"young\",children:\"Young (18-30)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"adult\",children:\"Adult (31-50)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"senior\",children:\"Senior (50+)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Fitness Level\"}),/*#__PURE__*/_jsxs(\"select\",{value:userProfile.fitness_level,onChange:e=>setUserProfile(prev=>({...prev,fitness_level:e.target.value})),className:\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"beginner\",children:\"Beginner\"}),/*#__PURE__*/_jsx(\"option\",{value:\"intermediate\",children:\"Intermediate\"}),/*#__PURE__*/_jsx(\"option\",{value:\"advanced\",children:\"Advanced\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Preferences\"}),/*#__PURE__*/_jsxs(\"select\",{value:userProfile.preferences,onChange:e=>setUserProfile(prev=>({...prev,preferences:e.target.value})),className:\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"general wellness\",children:\"General Wellness\"}),/*#__PURE__*/_jsx(\"option\",{value:\"weight loss\",children:\"Weight Loss\"}),/*#__PURE__*/_jsx(\"option\",{value:\"strength building\",children:\"Strength Building\"}),/*#__PURE__*/_jsx(\"option\",{value:\"flexibility\",children:\"Flexibility\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cardiovascular\",children:\"Cardiovascular\"})]})]})]})]}),(exercise_recommendations===null||exercise_recommendations===void 0?void 0:exercise_recommendations.daily_exercises)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"Recommended Daily Exercises\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:exercise_recommendations.daily_exercises.map(renderExerciseCard)})]}),(exercise_recommendations===null||exercise_recommendations===void 0?void 0:exercise_recommendations.weekly_plan)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"Weekly Exercise Plan\"}),renderWeeklyPlan(exercise_recommendations.weekly_plan)]}),(exercise_recommendations===null||exercise_recommendations===void 0?void 0:exercise_recommendations.general_advice)&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-blue-800 mb-2\",children:\"General Advice\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-700\",children:exercise_recommendations.general_advice})]}),(exercise_recommendations===null||exercise_recommendations===void 0?void 0:exercise_recommendations.contraindications)&&exercise_recommendations.contraindications.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-red-800 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 mr-2\"}),\"Important Precautions\"]}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:exercise_recommendations.contraindications.map((item,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"text-red-700 flex items-start\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500 mr-2\",children:\"\\u2022\"}),item]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5 mr-2\"}),\"Google Calendar Integration\"]}),!calendarIntegration.authorized?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Connect your Google Calendar to automatically schedule exercise reminders\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleGoogleCalendarAuth,disabled:calendarIntegration.loading,className:\"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 flex items-center mx-auto\",children:[calendarIntegration.loading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}):/*#__PURE__*/_jsx(ExternalLink,{className:\"w-4 h-4 mr-2\"}),\"Connect Google Calendar\"]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center text-green-600 mb-4\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 mr-2\"}),\"Google Calendar Connected\"]}),calendarIntegration.events.length===0?/*#__PURE__*/_jsxs(\"button\",{onClick:createCalendarEvents,disabled:calendarIntegration.loading,className:\"bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 flex items-center mx-auto\",children:[calendarIntegration.loading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}):/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4 mr-2\"}),\"Schedule Exercise Reminders\"]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-green-600 mb-2\",children:[\"\\u2713 \",calendarIntegration.events.length,\" exercise reminders scheduled\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Check your Google Calendar for upcoming exercise sessions\"})]})]})]})]})]})});};export default ExerciseRecommendations;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}